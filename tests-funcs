# Created by: WestleyR
# email: westleyr@nym.hush.com
# Date: Aug 18, 2019
# https://github.com/WestleyR/list-files
# version-1.0.0
#
# The Clear BSD License
#
# Copyright (c) 2019 WestleyR
# All rights reserved.
#
# This software is licensed under a Clear BSD License.
#

# usage:
# run-test <test-name> <test-command> <expect-to-contain-output> <expect-exit-code>
#
run-test() {
	test_name=$1
	test_cmd=$2
	expect_contain_out=$3
	expect_exit_code=$4


	echo "Running: ${test_name} ..."

	output=`$test_cmd 2>&1`
	exit_code=$?
	if [ $exit_code -ne $expect_exit_code ]; then
		echo "FAIL: expecting exit code: ${expect_exit_code}, got ${exit_code}"
		echo "while running: ${test_cmd}"
		exit 1
	fi

	if [[ -n $2 ]]; then
		if [[ ! -n $(echo "$output" | grep "$expect_contain_out") ]]; then
			echo "FAIL: expected outout to contain: ${expect_contain_out}, got: ${output}"
			echo "while running: ${test_cmd}"
			exit 1
		fi
	fi
}

#
# End tests-funcs
#


. ./tests-funcs

# run-test <test-name> <test-command> <expect-to-contain-output> <expect-exit-code>

# check to see if bc is installed, if not, then skip this test.
if ! require_cmd "bc"; then
    echo "bc is require for this test; skipping"
    exit 1
fi

# we -1 because ls outputs one extra line
run-test "lf -m | wc, ls -l | wc" "LF_MR_AUTO_OUTPUT=1 ./lf  -m tests/testdata | wc -l" "$(echo $(ls -l tests/testdata | wc -l)-1 | bc)" "" 0

run-test "lf -m /dev | wc, ls -l | wc" "LF_MR_AUTO_OUTPUT=1 ./lf  -m /dev | wc -l" "$(echo $(ls -l /dev | wc -l)-1 | bc)" "" 0

run-test "lf -m /usr | wc, ls -l | wc" "LF_MR_AUTO_OUTPUT=1 ./lf  -m /usr | wc -l" "$(echo $(ls -l /usr | wc -l)-1 | bc)" "" 0

# Try with color
run-test "lf -m (color) /usr | wc, ls -l | wc" "LF_MR_AUTO_OUTPUT=1 ./lf  -m --color=on /usr | wc -l" "$(echo $(ls -l /usr | wc -l)-1 | bc)" "" 0

